# Maintainer: Will Reed <wreed@disroot.org>

pkgname=vendr
pkgver=0.2.1
pkgrel=1
pkgdesc="Easy way to vendor your projects' dependencies"
arch=('x86_64')
url=https://github.com/wreedb/vendr
license=('GPL-3.0-or-later')
source=("https://github.com/wreedb/vendr/releases/download/${pkgver}/${pkgname}-${pkgver}.source.tar.gz")
b2sums=('de6d302d1a59e751edc6cf616f442606d61e860f19a0c06fbca9d17b786c93f96602976d681cab374828c23083da13cc478ae19a767d9acfe49967122903f093')
provides=('vendr')
depends=(libgit2 curl tomlplusplus)
makedepends=(meson gcc scdoc)

_srcdir="${pkgname}-${pkgver}.source"

prepare() {
    cd ${_srcdir}
    meson setup .build \
        --prefix=/usr \
        --buildtype=release \
        -D tomlpp-header-only=false \
        -D cpp_args="${CXXFLAGS}" \
        -D cpp_link_args="${LDFLAGS}"
}

build() {
    cd ${_srcdir}
    meson compile -C .build
}

package() {
    cd ${_srcdir}
    meson install -C .build --destdir ${pkgdir}
    install -dm 0755 ${pkgdir}/usr/share/licenses/${pkgname}
    cp -a licenses/* -t ${pkgdir}/usr/share/licenses/${pkgname}
}
